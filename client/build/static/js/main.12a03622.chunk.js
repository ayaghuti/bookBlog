(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{61:function(e,t,a){},92:function(e,t,a){"use strict";a.r(t);var n=a(2),s=a(1),r=a(21),c=a.n(r),o=(a(60),a(16)),i=a(17),l=a(19),u=a(18),h=(a(61),a(27)),d=a(10),j=a(11),p=a(24),b=a(52),O=a(54),g=a(7),m="FETCH_ALL",f="CREATE",x="UPDATE",v="DELETE_POST",y="LIKE",S="POSTS_LOADING",C="MOUNT_UPDATE",k="USER_LOADING",A="USER_LOADED",E="AUTH_ERROR",_="LOGIN_SUCCESS",w="LOGIN_FAIL",N="LOGOUT_SUCCESS",T="SIGNUP_SUCCESS",I="SIGNUP_FAIL",L="GET_ERRORS",U="CLEAR_ERRORS",P={posts:[],toBeEdited:null,loading:!1},D={token:localStorage.getItem("token"),isAuthenticated:!1,isLoading:!1,user:null},R={message:{},status:null,id:null},F=Object(p.c)({post:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return Object(g.a)(Object(g.a)({},e),{},{posts:t.payload,loading:!1});case f:return Object(g.a)(Object(g.a)({},e),{},{posts:[].concat(Object(O.a)(e.posts),[t.payload]),loading:!1});case y:case x:return Object(g.a)(Object(g.a)({},e),{},{posts:e.posts.map((function(e){return e._id===t.payload._id?t.payload:e})),toBeEdited:null});case v:return Object(g.a)(Object(g.a)({},e),{},{posts:e.posts.filter((function(e){return e._id!==t.payload}))});case S:return Object(g.a)(Object(g.a)({},e),{},{loading:!0});case C:return Object(g.a)(Object(g.a)({},e),{},{toBeEdited:t.payload});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(g.a)(Object(g.a)({},e),{},{isLoading:!0});case A:return Object(g.a)(Object(g.a)({},e),{},{isAuthenticated:!0,isLoading:!1,user:t.payload});case _:case T:return localStorage.setItem("token",t.payload.token),console.log("login success"),Object(g.a)(Object(g.a)(Object(g.a)({},e),t.payload),{},{isAuthenticated:!0,isLoading:!1});case N:case w:case I:case E:return localStorage.removeItem("token"),Object(g.a)(Object(g.a)({},e),{},{token:null,user:null,isAuthenticated:!1,isLoading:!1});default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return{message:t.payload.message,status:t.payload.status,id:t.payload.id};case U:return{message:{},status:null,id:null};default:return e}}}),B=[b.a],G=Object(p.e)(F,{},Object(p.d)(p.a.apply(void 0,B),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),J=a(28),X=a(93),M=a(94),H=a(95),V=a(96),W=a(97),Y=a(98),K=a(99),q=a(100),z=a(20),Q=a.n(z),Z=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:L,payload:{message:e,status:t,id:a}}},$=function(){return{type:U}},ee=function(e){var t=e().auth.token,a={headers:{"Content-type":"application/json"}};return t&&(a.headers["x-auth-token"]=t),a},te=function(){var e=Object(j.c)(),t=Object(j.d)((function(e){return e.auth})),a=Object(s.useState)(!1),r=Object(J.a)(a,2),c=r[0],o=r[1],i=Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(X.a,{children:Object(n.jsx)("span",{className:"navbar-text mr-3",children:Object(n.jsx)("strong",{children:t.user?"Welcome ".concat(t.user.name):""})})}),Object(n.jsx)(X.a,{children:Object(n.jsx)(M.a,{href:"/",onClick:function(){e((console.log("user logged out"),{type:N}))},children:"Logout"})}),Object(n.jsx)(X.a,{children:Object(n.jsx)(M.a,{href:"/create",children:"New Post"})})]}),l=Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)(X.a,{children:Object(n.jsx)(M.a,{href:"/signup",children:"Sign Up"})}),Object(n.jsx)(X.a,{children:Object(n.jsx)(M.a,{href:"/signin",children:"Sign In"})})]});return Object(n.jsx)("div",{children:Object(n.jsx)(H.a,{color:"dark",dark:!0,expand:"sm",children:Object(n.jsxs)(V.a,{children:[Object(n.jsx)(W.a,{href:"/",children:"BookBlog"}),Object(n.jsx)(Y.a,{onClick:function(){return o(!c)}}),Object(n.jsx)(K.a,{isOpen:c,navbar:!0,children:Object(n.jsx)(q.a,{className:"ml-auto",navbar:!0,children:t.isAuthenticated?i:l})})]})})})},ae=function(){return{type:S}},ne=a(101),se=a(102),re=a(103),ce=a(104),oe=a(105),ie=a(106),le=a(107),ue=a(108),he=a(109),de=a(110),je=a(53),pe=a.n(je),be=function(e){var t=e.post,a=Object(j.d)((function(e){return e.auth})),r=Object(d.g)(),c=Object(j.c)(),o=t.title,i=t.author,l=t.message,u=t.creator,h=Object(s.useState)(null),p=Object(J.a)(h,2),b=p[0],O=p[1],g=function(e,t){if(e.preventDefault(),!a.isAuthenticated)return O("Please sign in to get the most of this site!"),setTimeout((function(){return O(null)}),3e3),void setTimeout((function(){return r.push("/signin")}),3e3);c(function(e,t){return function(a,n){Q.a.patch("/posts/".concat(e,"/likepost"),t,ee(n)).then((function(e){a({type:y,payload:e.data})})).catch((function(e){a(Z(e.response.data,e.response.status))}))}}(t))},m=function(e,t){return e.preventDefault(),a.isAuthenticated?a.user.name!==t.creator?(O("You can modify only the posts created by you!"),void setTimeout((function(){return O(null)}),3e3)):(c(function(e){return{type:C,payload:e}}(t)),void r.push("/update")):(O("Please sign in to get the most of this site!"),setTimeout((function(){return O(null)}),3e3),void setTimeout((function(){return r.push("/signin")}),3e3))},f=function(e,n){return e.preventDefault(),a.isAuthenticated?a.user.name!==t.creator?(O("You can remove only the posts created by you!"),void setTimeout((function(){return O(null)}),3e3)):void c(function(e){return function(t,a){Q.a.delete("/posts/".concat(e),ee(a)).then((function(a){return t({type:v,payload:e})})).catch((function(e){t(Z(e.response.data,e.response.status))}))}}(n)):(O("Please sign in to get the most of this site!"),setTimeout((function(){return O(null)}),3e3),void setTimeout((function(){return r.push("/signin")}),3e3))};return Object(n.jsxs)("div",{children:[b?Object(n.jsx)(ne.a,{color:"primary",className:"mt-3",children:b}):null,Object(n.jsxs)(se.a,{className:"mb-3",children:[Object(n.jsxs)(re.a,{children:["Created by: ",u,Object(n.jsxs)("p",{children:["Created at: ",pe()(t.date).fromNow()]})]}),Object(n.jsxs)(ce.a,{children:[Object(n.jsxs)(oe.a,{tag:"h5",children:["Book Title: ",o]}),Object(n.jsxs)(ie.a,{tag:"h6",className:"mb-2 text-muted",children:["Author: ",i]}),Object(n.jsxs)(le.a,{children:["About this book: ",l]})]}),Object(n.jsx)(ue.a,{children:Object(n.jsxs)(he.a,{className:"pull-right",children:[Object(n.jsx)(de.a,{href:"#",color:"primary",onClick:function(e){return g(e,t._id)},children:Object(n.jsxs)("i",{className:"fas fa-thumbs-up",children:[" ",t.likes.length]})}),Object(n.jsxs)(de.a,{href:"#",onClick:function(e){return m(e,t)},children:[Object(n.jsx)("i",{className:"fas fa-edit"}),"edit"]}),Object(n.jsxs)(de.a,{href:"#",color:"danger",onClick:function(e){return f(e,t._id)},children:[Object(n.jsx)("i",{className:"fas fa-delete"}),"Delete"]})]})})]})]})},Oe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.getPosts()}},{key:"render",value:function(){var e=this.props.post.posts;return Object(n.jsx)("div",{children:e.length?e.map((function(e){return Object(n.jsx)(be,{post:e},e._id)})):"No post yet..."})}}]),a}(s.Component),ge=Object(j.b)((function(e){return{post:e.post}}),{getPosts:function(){return function(e){e(ae()),Q.a.get("/posts").then((function(t){return e({type:m,payload:t.data})})).catch((function(t){e(Z(t.response.data,t.response.status))}))}}})(Oe),me=a(111),fe=function(){return Object(n.jsx)(V.a,{children:Object(n.jsxs)(me.a,{className:"jtron",children:[Object(n.jsx)("h1",{className:"display-3",children:"Welcome to BookBlog!"}),Object(n.jsx)("p",{className:"lead",children:"This is a place for exchanging information on books. Share your experience from books with others!"})]})})},xe=function(){return Object(n.jsxs)(V.a,{children:[Object(n.jsx)(fe,{}),Object(n.jsx)(ge,{})]})},ve=a(22),ye=a(119),Se=a(112),Ce=a(113),ke=a(114),Ae=a(115),Ee=a(116),_e=a(117),we=a(118),Ne=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={modal:!1,message:null,email:"",password:""},e.toggle=function(){e.setState({modal:!e.state.modal})},e.handleSubmit=function(t){t.preventDefault();var a=e.state,n={email:a.email,password:a.password};e.props.signInUser(n)},e.handleChange=function(t){e.setState(Object(g.a)(Object(g.a)({},e.state),{},Object(ve.a)({},t.target.name,t.target.value)))},e}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props.error;t!==e.error&&("LOGIN_FAIL"===t.id?(this.setState({message:t.message.message}),this.toggle()):this.setState({message:null}))}},{key:"render",value:function(){var e=this;return this.props.auth.isAuthenticated?Object(n.jsx)(d.a,{to:"/"}):Object(n.jsxs)("div",{children:[Object(n.jsxs)(ye.a,{isOpen:this.state.modal,toggle:this.toggle,onClick:this.toggle,children:[Object(n.jsx)(Se.a,{toggle:this.toggle,children:"Error:"}),Object(n.jsx)(Ce.a,{children:this.state.message})]}),Object(n.jsx)(ke.a,{autoComplete:"off",onSubmit:this.handleSubmit,children:Object(n.jsxs)(V.a,{className:"mt-3",children:[Object(n.jsx)("h4",{children:"Sign In"}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"email",children:"Email"}),Object(n.jsx)(_e.a,{type:"email",name:"email",id:"email",placeholder:"Email",value:this.state.email,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"password",children:"Password"}),Object(n.jsx)(_e.a,{type:"password",name:"password",id:"password",placeholder:"Password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsx)(we.a,{block:!0,children:"Sign In"})]})})]})}}]),a}(s.Component),Te=Object(j.b)((function(e){return{auth:e.auth,error:e.error}}),{signInUser:function(e){var t=e.email,a=e.password;return function(e){var n=JSON.stringify({email:t,password:a});Q.a.post("/auth",n,{headers:{"content-type":"application/json"}}).then((function(t){return e({type:_,payload:t.data})})).catch((function(t){e(Z(t.response.data,t.response.status,"LOGIN_FAIL")),e({type:w})}))}}})(Ne),Ie=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={modal:!1,message:"",name:"",email:"",password:""},e.toggle=function(){e.setState({modal:!e.state.modal})},e.handleSubmit=function(t){t.preventDefault();var a=e.state,n={name:a.name,email:a.email,password:a.password};e.props.signUpUser(n)},e.handleChange=function(t){e.setState(Object(g.a)(Object(g.a)({},e.state),{},Object(ve.a)({},t.target.name,t.target.value)))},e}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props.error;t!==e.error&&("SIGNUP_FAIL"===t.id?(this.setState({message:t.message.message}),this.toggle()):this.setState({message:null}))}},{key:"render",value:function(){var e=this;return this.props.isAuthenticated?Object(n.jsx)(d.a,{to:"/"}):Object(n.jsxs)("div",{children:[Object(n.jsxs)(ye.a,{isOpen:this.state.modal,toggle:this.toggle,onClick:this.toggle,children:[Object(n.jsx)(Se.a,{toggle:this.toggle,children:"Error:"}),Object(n.jsx)(Ce.a,{children:this.state.message})]}),Object(n.jsx)(ke.a,{autoComplete:"off",onSubmit:this.handleSubmit,children:Object(n.jsxs)(V.a,{className:"mt-3",children:[Object(n.jsx)("h4",{children:"Sign Up"}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"name",children:"Name"}),Object(n.jsx)(_e.a,{type:"text",name:"name",id:"name",placeholder:"Name",value:this.state.name,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"email",children:"Email"}),Object(n.jsx)(_e.a,{type:"email",name:"email",id:"email",placeholder:"Email",value:this.state.email,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"password",children:"Password"}),Object(n.jsx)(_e.a,{type:"password",name:"password",id:"password",placeholder:"Password",value:this.state.password,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsx)(we.a,{block:!0,children:"Sign Up"})]})})]})}}]),a}(s.Component),Le=Object(j.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,error:e.error}}),{signUpUser:function(e){var t=e.name,a=e.email,n=e.password;return function(e){var s=JSON.stringify({name:t,email:a,password:n});Q.a.post("/users",s,{headers:{"content-type":"application/json"}}).then((function(t){e($()),e({type:T,payload:t.data})})).catch((function(t){e(Z(t.response.data,t.response.status,"SIGNUP_FAIL")),e({type:I})}))}}})(Ie),Ue=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).state={modal:!1,error:null,title:"",author:"",user:null,message:""},e.toggle=function(){return e.setState({modal:!e.state.modal})},e.handleSubmit=function(t){t.preventDefault();var a=e.state,n={title:a.title,author:a.author,message:a.message,creator:e.props.auth.user.name,user:e.props.auth.user};e.props.createPost(n)},e.handleChange=function(t){e.setState(Object(g.a)(Object(g.a)({},e.state),{},Object(ve.a)({},t.target.name,t.target.value)))},e}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.error,n=t.loading;n!==e.loading&&(n||this.props.history.push("/")),a!==e.error&&("CREATE_POST_FAIL"===a.id?(this.setState({error:a.message.message}),this.toggle()):this.setState({error:null}))}},{key:"render",value:function(){var e=this;return Object(n.jsxs)("div",{children:[Object(n.jsxs)(ye.a,{isOpen:this.state.modal,toggle:this.toggle,onClick:this.toggle,children:[Object(n.jsx)(Se.a,{toggle:this.toggle,children:"Error:"}),Object(n.jsx)(Ce.a,{children:this.state.error})]}),Object(n.jsx)(ke.a,{autoComplete:"off",onSubmit:this.handleSubmit,children:Object(n.jsxs)(V.a,{children:[Object(n.jsx)("h4",{children:"New Post"}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"title",children:"Title"}),Object(n.jsx)(_e.a,{type:"text",name:"title",id:"title",placeholder:"Book Title",value:this.state.title,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"author",children:"Author"}),Object(n.jsx)(_e.a,{type:"text",name:"author",id:"author",placeholder:"Author",value:this.state.author,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"message",children:"About this book"}),Object(n.jsx)(_e.a,{type:"textarea",name:"message",id:"message",value:this.state.message,onChange:function(t){return e.handleChange(t)}})]}),Object(n.jsx)(we.a,{type:"submit",block:!0,children:"Add Post"})]})})]})}}]),a}(s.Component),Pe=Object(j.b)((function(e){return{loading:e.post.loading,auth:e.auth,error:e.error}}),{createPost:function(e){return function(t,a){t(ae()),Q.a.post("/posts",e,ee(a)).then((function(e){return t({type:f,payload:e.data})})).catch((function(e){t(Z(e.response.data,e.response.status,"CREATE_POST_FAIL"))}))}}})(Ue),De=function(){var e=Object(j.d)((function(e){return e.post.toBeEdited})),t=e.title,a=e.author,r=e.message,c=e._id,o=Object(s.useState)({title:t,author:a,message:r,_id:c}),i=Object(J.a)(o,2),l=i[0],u=i[1],h=Object(j.c)(),p=Object(d.g)();return Object(n.jsx)(ke.a,{autoComplete:"off",onSubmit:function(e){var t,a;e.preventDefault(),h((t=l._id,a=l,function(e,n){Q.a.patch("/posts/".concat(t),a,ee(n)).then((function(t){e({type:x,payload:t.data})})).catch((function(t){e(Z(t.response.data,t.response.status))}))})),p.push("/")},children:Object(n.jsxs)(V.a,{children:[Object(n.jsx)("h4",{children:"Update Post"}),Object(n.jsxs)("h5",{children:["Post ID: ",l._id]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"title",children:"Title"}),Object(n.jsx)(_e.a,{type:"text",name:"title",id:"title",placeholder:"Book Title",value:l.title,onChange:function(e){return u(Object(g.a)(Object(g.a)({},l),{},{title:e.target.value}))}})]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"author",children:"Author"}),Object(n.jsx)(_e.a,{type:"text",name:"author",id:"author",placeholder:"Author",value:l.author,onChange:function(e){return u(Object(g.a)(Object(g.a)({},l),{},{author:e.target.value}))}})]}),Object(n.jsxs)(Ae.a,{children:[Object(n.jsx)(Ee.a,{for:"message",children:"About this book"}),Object(n.jsx)(_e.a,{type:"textarea",name:"text",id:"message",value:l.message,onChange:function(e){return u(Object(g.a)(Object(g.a)({},l),{},{message:e.target.value}))}})]}),Object(n.jsx)(we.a,{type:"submit",block:!0,children:"Update Post"})]})})},Re=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){G.dispatch((function(e,t){e({type:k}),Q.a.get("/auth/user",ee(t)).then((function(t){e($()),e({type:A,payload:t.data})})).catch((function(t){e(Z(t.response.data,t.response.status)),e({type:E})}))}))}},{key:"render",value:function(){return Object(n.jsx)(j.a,{store:G,children:Object(n.jsx)(h.a,{children:Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(te,{}),Object(n.jsxs)(d.d,{children:[Object(n.jsx)(d.b,{exact:!0,path:"/",component:xe}),Object(n.jsx)(d.b,{path:"/signin",component:Te}),Object(n.jsx)(d.b,{path:"/signup",component:Le}),Object(n.jsx)(d.b,{path:"/create",component:Pe}),Object(n.jsx)(d.b,{path:"/update",component:De})]})]})})})}}]),a}(s.Component),Fe=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,120)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,r=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),r(e),c(e)}))};c.a.render(Object(n.jsx)(Re,{}),document.getElementById("root")),Fe()}},[[92,1,2]]]);
//# sourceMappingURL=main.12a03622.chunk.js.map